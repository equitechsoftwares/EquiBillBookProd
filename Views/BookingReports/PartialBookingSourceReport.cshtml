@{
    var sourceData = ViewBag.SourceData as System.Collections.Generic.List<dynamic> ?? new System.Collections.Generic.List<dynamic>();
}
<thead id="thead">
    <tr>
        <th>Source</th>
        <th>Total Bookings</th>
        <th>Confirmed</th>
        <th>Completed</th>
        <th>Cancelled</th>
        <th>Total Revenue</th>
        <th>Average Guests</th>
    </tr>
</thead>
<tbody class="table-body">
    @if (sourceData != null && sourceData.Count > 0)
    {
        foreach (var source in sourceData)
        {
            <tr>
                <td>@(source.Source ?? "-")</td>
                <td>@(source.TotalBookings ?? 0)</td>
                <td>@(source.ConfirmedBookings ?? 0)</td>
                <td>@(source.CompletedBookings ?? 0)</td>
                <td>@(source.CancelledBookings ?? 0)</td>
                <td>@(source.TotalRevenue != null ? ((decimal)source.TotalRevenue).ToString("N2") : "0.00")</td>
                <td>@(source.AverageGuests != null ? ((double)source.AverageGuests).ToString("N1") : "0.0")</td>
            </tr>
        }
    }
</tbody>

