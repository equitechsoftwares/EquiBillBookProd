@{
    var customerFrequency = ViewBag.CustomerFrequency as System.Collections.Generic.List<dynamic> ?? new System.Collections.Generic.List<dynamic>();
}
<thead id="thead">
    <tr>
        <th>Customer Name</th>
        <th>Mobile</th>
        <th>Total Visits</th>
        <th>Completed Visits</th>
        <th>Cancelled Visits</th>
        <th>Total Spent</th>
        <th>Average Spent</th>
        <th>First Visit</th>
        <th>Last Visit</th>
    </tr>
</thead>
<tbody class="table-body">
    @if (customerFrequency != null && customerFrequency.Count > 0)
    {
        foreach (var customer in customerFrequency)
        {
            <tr>
                <td>@(customer.CustomerName ?? "-")</td>
                <td>@(customer.CustomerMobile ?? "-")</td>
                <td>@(customer.TotalVisits ?? 0)</td>
                <td>@(customer.CompletedVisits ?? 0)</td>
                <td>@(customer.CancelledVisits ?? 0)</td>
                <td>@(customer.TotalSpent != null ? ((decimal)customer.TotalSpent).ToString("N2") : "0.00")</td>
                <td>@(customer.AverageSpent != null ? ((decimal)customer.AverageSpent).ToString("N2") : "0.00")</td>
                <td>@(customer.FirstVisitDate != null ? ((DateTime)customer.FirstVisitDate).ToString("dd/MM/yyyy") : "-")</td>
                <td>@(customer.LastVisitDate != null ? ((DateTime)customer.LastVisitDate).ToString("dd/MM/yyyy") : "-")</td>
            </tr>
        }
    }
</tbody>

