@{
    ViewBag.Title = Request.Cookies["data"].Value.Split('&')[8].Split('=')[1] + " | Kitchen Stations";
    Layout = "~/Views/Shared/_CustomerLayout.cshtml";
}

<section class="content-header">
    <div class="container-fluid">
        <div class="row mb-2">
            <div class="col-sm-6">
                <h1>Kitchen Stations</h1>
                <div class="float-left">
                    <ol class="breadcrumb float-sm-right">
                        <li class="breadcrumb-item"><a href="/dashboard/index">Dashboard</a></li>
                        <li class="breadcrumb-item"><a href="/settings/index">Settings</a></li>
                        <li class="breadcrumb-item active">Kitchen Stations</li>
                    </ol>
                </div>
            </div>
            <div class="col-sm-6">
                <a id="btnBack" href="/settings/index" class="btn btn-warning float-sm-right mr-2"><i class="fas fa-arrow-left"></i> Back</a>
                @if (ViewBag.MenuPermission != null && ViewBag.MenuPermission.IsAdd)
                {
                    <a id="btnNew" href="/kitchenstation/add" class="btn btn-primary float-sm-right mr-2"><i class="fas fa-plus"></i> Add New</a>
                }
            </div>
        </div>
    </div>
</section>

<section class="content">
    <div class="container-fluid">
        <div class="row">
            <div class="col-12">
                <div class="card card-primary card-outline collapsed-card">
                    <div class="card-header" data-card-widget="collapse">
                        <h3 class="card-title">Filter</h3>
                        <div class="card-tools">
                            <button type="button" class="btn btn-tool" data-card-widget="collapse">
                                <i class="fas fa-plus"></i>
                            </button>
                        </div>
                    </div>
                    <div class="card-body">
                        <div class="row">
                            <div class="col-12 col-sm-6 col-md-4 col-lg-3 col-xl-2">
                                <div class="form-group">
                                    <label>Search</label>
                                    <input type="text" class="form-control" id="txtSearch" placeholder="Station Name">
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="card-footer">
                        <button type="submit" class="btn btn-primary float-right mt-2" onclick="fetchList(1)">Search</button>
                        <button type="submit" class="btn btn-warning float-right mt-2 mr-2" onclick="window.location.reload()">Refresh</button>
                    </div>
                </div>
            </div>
            <div class="col-12">
                <div class="card card-primary card-outline">
                    <div class="card-header">
                        <div class="row">
                            <div class="col-sm-6">
                                <h5>
                                    <span class="success" id="divTotalCount">Total : @(ViewBag.TotalCount ?? 0)</span> |
                                    <span class="primary" id="divActiveCount">Active : @(ViewBag.ActiveCount ?? 0)</span> |
                                    <span class="danger" id="divInactiveCount">In-Active : @(ViewBag.InactiveCount ?? 0)</span>
                                </h5>
                            </div>
                        </div>
                    </div>
                    <div class="card-body">
                        <table id="tblStations" class="table table-bordered table-striped">
                            <thead>
                                <tr>
                                    <th>Station Name</th>
                                    <th>Station Type</th>
                                    <th>Printer</th>
                                    <th class="hidden">Status</th>
                                    <th class="hide">Status</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody>
                                @if (ViewBag.Stations != null)
                                {
                                    foreach (var item in ViewBag.Stations)
                                    {
                                        <tr>
                                            <td>@item.StationName</td>
                                            <td>@(item.StationType ?? "-")</td>
                                            <td>@(item.PrinterName ?? "-")</td>
                                            <td class="hidden">@(item.IsActive == true ? "Active" : "Inactive")</td>
                                            <td class="hide">
                                                @if (item.IsActive)
                                                {
                                                    if (ViewBag.MenuPermission != null && ViewBag.MenuPermission.IsEdit)
                                                    {
                                                        <input class="chkIsActive" type="checkbox" onchange="ActiveInactive(@item.KitchenStationId, false)" checked data-on="Active" data-off="In Active" data-toggle="toggle" data-onstyle="success" data-offstyle="danger" data-width="100" data-height="25" data-style="design">
                                                    }
                                                    else
                                                    {
                                                        <input disabled class="chkIsActive" type="checkbox" checked data-on="Active" data-off="In Active" data-toggle="toggle" data-onstyle="success" data-offstyle="danger" data-width="100" data-height="25" data-style="design">
                                                    }
                                                }
                                                else
                                                {
                                                    if (ViewBag.MenuPermission != null && ViewBag.MenuPermission.IsEdit)
                                                    {
                                                        <input class="chkIsActive" type="checkbox" onchange="ActiveInactive(@item.KitchenStationId, true)" data-on="Active" data-off="In Active" data-toggle="toggle" data-onstyle="success" data-offstyle="danger" data-width="100" data-height="25" data-style="design">
                                                    }
                                                    else
                                                    {
                                                        <input disabled class="chkIsActive" type="checkbox" data-on="Active" data-off="In Active" data-toggle="toggle" data-onstyle="success" data-offstyle="danger" data-width="100" data-height="25" data-style="design">
                                                    }
                                                }
                                            </td>
                                            <td>
                                                @if (ViewBag.MenuPermission != null && ViewBag.MenuPermission.IsEdit)
                                                {
                                                    <a href="/kitchenstation/edit/@item.KitchenStationId" class="btn btn-sm btn-primary"><i class="fas fa-edit"></i></a>
                                                }
                                                @if (ViewBag.MenuPermission != null && ViewBag.MenuPermission.IsDelete)
                                                {
                                                    <a href="javascript:void(0)" onclick="deleteStation(@item.KitchenStationId)" class="btn btn-sm btn-danger"><i class="fas fa-trash"></i></a>
                                                }
                                            </td>
                                        </tr>
                                    }
                                }
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<script src="~/Content/JQuery/Customer/Restaurant/KitchenStation.js"></script>
<script>
    $(document).ready(function () {
        // Initialize toggle switches
        $('.chkIsActive').bootstrapToggle();
        
        // Check for success message in query parameter
        var urlParams = new URLSearchParams(window.location.search);
        var successMessage = urlParams.get('success');
        if (successMessage) {
            if (EnableSound == 'True') { document.getElementById('success').play(); }
            toastr.success(decodeURIComponent(successMessage));
            // Clean up URL by removing query parameter
            if (window.history && window.history.replaceState) {
                window.history.replaceState({}, document.title, window.location.pathname);
            }
        }
    });
</script>


